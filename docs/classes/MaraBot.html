<!DOCTYPE html>
<html lang="en">
<head>
    <title>MaraBot</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../css/github.css" type="text/css" media="screen" />
<script src="../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="MaraBot">

  
    
    <meta name="description" content="The primary interfact with which the application interacts with the telegram api via the telegram_bot gem.">
    <meta property="og:description" content="The primary interfact with which the application interacts with the telegram api via the telegram_bot gem.">
  

    <meta name="keywords" content="MaraBot class">
  
    <meta name="keywords" content="new, run">
  
</head>

<body>
    <div class="banner">
        
        <h1>
            <span class="type">Class</span>
            MaraBot
            
                <span class="parent">&lt;
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../files/app/models/mara_bot_rb.html">app/models/mara_bot.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>The primary interfact with which the application interacts with the
telegram api via the telegram_bot gem.</p>

<p>It currently does not process state or &#39;remember&#39; conversations, so
does not have persistence handling. This is likely to be developed at some
point in the future. Any bot interactions must be done explicitly through
this object and not directly through the Telegram_Bot.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-run">run</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    
      <!-- Section constants -->
      <div class="sectiontitle">Constants</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class="attr-name">MARA_BOT_KEY</td>
            <td>=</td>
            <td class="attr-value">ENV[&#39;mara_bot_key&#39;]</td>
          </tr>
          
            <tr valign='top'>
              <td>&nbsp;</td>
              <td colspan="2" class="attr-desc"></td>
            </tr>
          
        
      </table>
    


    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <b>new</b>()
            
            <a href="../classes/MaraBot.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Instantiates the bot variable as a new Telegram bot.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File app/models/mara_bot.rb, line 15</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
  <span class="ruby-ivar">@bot</span> = <span class="ruby-constant">TelegramBot</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">token</span><span class="ruby-operator">:</span> <span class="ruby-constant">MARA_BOT_KEY</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-run">
            
              <b>run</b>()
            
            <a href="../classes/MaraBot.html#method-i-run" name="method-i-run" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Runs the bot, it must always be running &#39;live&#39; on its own
process/worker in order to receive updates.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-run_source')" id="l_method-i-run_source">show</a>
                
              </p>
              <div id="method-i-run_source" class="dyn-source">
                <pre><span class="ruby-comment"># File app/models/mara_bot.rb, line 23</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">run</span>
  <span class="ruby-ivar">@bot</span>.<span class="ruby-identifier">get_updates</span>(<span class="ruby-identifier">fail_silently</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">message</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;@#{message.from.username}: #{message.text}&quot;</span>
    <span class="ruby-identifier">command</span> = <span class="ruby-identifier">message</span>.<span class="ruby-identifier">get_command_for</span>(<span class="ruby-ivar">@bot</span>)

    <span class="ruby-identifier">message</span>.<span class="ruby-identifier">reply</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">reply</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">case</span> <span class="ruby-identifier">command</span>
      <span class="ruby-keyword">when</span> <span class="ruby-regexp">/greet/i</span>
        <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">text</span> = <span class="ruby-node">&quot;Hello, #{message.from.first_name}!&quot;</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">text</span> = <span class="ruby-node">&quot;#{message.from.first_name}, have no idea what #{command.inspect} means.&quot;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;sending #{reply.text.inspect} to @#{message.from.username}&quot;</span>
      <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">send_with</span>(<span class="ruby-ivar">@bot</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </div>
  </body>
</html>
